const e={zones:{},weeks:12,roles:[""]},t=document.getElementById("roles"),n=document.getElementById("progress"),o=document.getElementById("submit"),l=document.getElementById("csv"),r=document.getElementById("weeks"),s=document.getElementById("zone-data"),i=document.getElementById("error");let a=!1,p=0;function u(e){a=!0,o.disabled=!0,i.innerText=e}function d(){a&&(i.innerText="",o.disabled=!1),a=!1}function c(e){p=e,n.style.width=`${100*p}%`}document.addEventListener("DOMContentLoaded",()=>{l.value="",r.value=e.weeks,t.value=e.roles.join(", "),c(p)}),t.oninput=t=>{e.roles=t.target.value.split(",").map(e=>e.trim())},r.oninput=t=>{let n=parseInt(t.target.value);if(!Number.isInteger(n)||n<2)return void u("Number of weeks must be an integer greater than 2.");e.weeks=n,d()},l.onchange=t=>{e.zones={};let n=t.target.files[0];if(!n)return void u("Invalid CSV file.");let o=new FileReader;function l(e,t,n,o){let l=document.createElement("label");l.setAttribute("for",e),l.textContent=t;let r=document.createElement("input");return r.id=e,r.type="number",r.step="1",r.value="2",r.min="2",r.oninput=o,{input:r,label:l}}o.onload=t=>{let n=t.target.result.split("\n");n.length<2&&u("CSV requires at least 2 rows.");let o=n[0].split(",").map(e=>e.trim()),r=o.indexOf("person");-1===r&&u("Required column `person` is missing.");let i=o.indexOf("zone"),a=Math.max(r,i);for(let t of n.slice(1)){if(""==t)continue;let n=t.split(",").map(e=>e.trim());n.length<=a&&u("Invalid CSV file.");let o=-1!==i?n[i]:"",l=n[r];e.zones.hasOwnProperty(o)?e.zones[o].people.push(l):e.zones[o]={groups:2,tables:2,people:[l]}}Object.keys(e.zones).forEach((t,n)=>{s.appendChild(function(t,n){let o=document.createElement("li"),r=l(`groups-${2*t}`,"Number of groups",n,t=>{let o=parseInt(t.target.value);if(!Number.isInteger(o))return void u("Invalid number of groups");e.zones[n].groups=o,d()}),s=document.createElement("p");s.innerText=`${n} (${e.zones[n].people.length} people)`,o.appendChild(s),o.appendChild(r.label),o.appendChild(r.input);let i=l(`tables-${2*t+1}`,"Number of tables",n,t=>{let o=parseInt(t.target.value);if(!Number.isInteger(o))return void u("Invalid number of tables");e.zones[n].tables=o,d()});return o.appendChild(i.label),o.appendChild(i.input),o}(n,t))})},s.innerHTML="",o.readAsText(n)};var m={},g={};g=function(e,t,n){if(t===self.location.origin)return e;var o=n?"import "+JSON.stringify(e)+";":"importScripts("+JSON.stringify(e)+");";return URL.createObjectURL(new Blob([o],{type:"application/javascript"}))};let b=new URL(import.meta.resolve("2wF6P"));m=g(b.toString(),b.origin,!0),o.onclick=()=>{c(0);let t=structuredClone(e),n=Object.keys(t.zones).length,o={},l={},r={zone:[],week:[],person:[],table:[],group:[],role:[]};for(let[e,s]of Object.entries(t.zones)){let i=new Worker(m);i.postMessage({operation:"optimize",payload:{people:s.people,tables:s.tables,groups:s.groups,weeks:t.weeks,roles:t.roles}}),i.onmessage=t=>{let s=t.data.operation,a=t.data.payload;switch(s){case"result":{let t=a.person.length;r.zone.push(...Array(t).fill(e)),r.person.push(...a.person),r.table.push(...a.table),r.week.push(...a.week),r.group.push(...a.group),r.role.push(...a.role),i.terminate(),delete o[e],0===Object.keys(o).length&&(!function(e){let t=Object.keys(e),n=e[t[0]].length,o=[t];for(let l=0;l<n;l++){let n=[];for(let o of t)n.push(e[o][l]);o.push(n)}let l=new Blob([o.map(e=>e.join(",")).join("\n")],{type:"text/csv"}),r=URL.createObjectURL(l);window.open(r,"_blank")}(r),c(0));break}case"progress":l[e]=a,c(Object.values(l).reduce((e,t)=>e+t,0)/n);break;case"log":console.log(a)}},o[e]=i}};
//# sourceMappingURL=social_golfer_timetabling.7b8424fe.js.map

const e={zones:{},weeks:12,roles:["Leader","Scribe","Researcher"]},t=document.getElementById("roles"),n=document.getElementById("progress"),o=document.getElementById("submit"),r=document.getElementById("csv"),l=document.getElementById("weeks"),s=document.getElementById("zone-table"),i=document.getElementById("error");let a=!1,u=0;function p(e){a=!0,o.disabled=!0,i.innerText=e}function d(){a&&(i.innerText="",o.disabled=!1),a=!1}function c(e){u=e,n.style.width=`${100*u}%`}document.addEventListener("DOMContentLoaded",()=>{r.value="",l.value=e.weeks,t.value=e.roles.join(", "),o.disabled=!0,c(u)}),t.oninput=t=>{e.roles=t.target.value.split(",").map(e=>e.trim())},l.oninput=t=>{let n=parseInt(t.target.value);if(!Number.isInteger(n)||n<2)return void p("Number of weeks must be an integer greater than 2.");e.weeks=n,d()},r.onchange=t=>{e.zones={},o.disabled=!0;let n=t.target.files[0];if(!n)return void p("Invalid CSV file.");let r=new FileReader;function l(e,t,n){let o=document.createElement("input");return o.id=e,o.type="number",o.step="1",o.value=t,o.min="2",o.oninput=n,o}r.onload=t=>{d();let n=t.target.result.split("\n");n.length<2&&p("CSV requires at least 2 rows.");let o=n[0].toLowerCase().split(",").map(e=>e.trim()),r=o.indexOf("name");if(-1===r)return void p("Required column `name` is missing.");let i=o.indexOf("zone"),a=Math.max(r,i),u={};for(let t of n.slice(1)){if(""==t)continue;let n=t.split(",").map(e=>e.trim());if(n.length<=a)return void p("Invalid CSV file.");let o=-1!==i?n[i]:"",l=n[r];if(u.hasOwnProperty(o)||(u[o]=new Set),u[o].has(l))return void p(`Each name in the CSV must be unique in each zone (duplicate '${o}'-'${l}').`);u[o].add(l),e.zones.hasOwnProperty(o)?e.zones[o].people.push(l):e.zones[o]={groups:2,tables:2,people:[l]}}s.getElementsByTagName("tbody")[0].innerHTML="",Object.keys(e.zones).forEach((t,n)=>{!function(t,n){let o=s.getElementsByTagName("tbody")[0].insertRow(),r=[];for(let e=0;e<5;e++)r.push(o.insertCell());let i=e.zones[n].people.length;r[0].innerText=""===n?"Unnamed":n,r[1].innerText=i;let a=Math.max(2,Math.ceil(i/6)),u=i/a;e.zones[n].tables=a,e.zones[n].groups=a,r[2].innerText=u.toFixed(2);let c=l(`groups-${t}`,a,t=>{let o=parseInt(t.target.value),l=e.zones[n].people.length;if(!Number.isInteger(o))return void p("Invalid number of groups.");e.zones[n].tables<o&&(r[4].firstChild.value=o),r[2].innerText=(l/o).toFixed(2),e.zones[n].groups=o,d()}),g=l(`tables-${t}`,a,t=>{let o=parseInt(t.target.value);return Number.isInteger(o)?o<e.zones[n].groups?void p(`Each group must have a table in '${n}'.`):void(e.zones[n].tables=o,d()):void p("Invalid number of tables.")});r[3].appendChild(c),r[4].appendChild(g)}(n,t)}),s.style.display="table"},r.readAsText(n),a||(o.disabled=!1)};var g={},m={};m=function(e,t,n){if(t===self.location.origin)return e;var o=n?"import "+JSON.stringify(e)+";":"importScripts("+JSON.stringify(e)+");";return URL.createObjectURL(new Blob([o],{type:"application/javascript"}))};let b=new URL(import.meta.resolve("2wF6P"));g=m(b.toString(),b.origin,!0),o.onclick=()=>{c(0);let t=structuredClone(e),n=Object.keys(t.zones).length,o={},r={},l={zone:[],week:[],person:[],table:[],group:[],role:[]};for(let[e,s]of Object.entries(t.zones)){let i=new Worker(g);i.postMessage({operation:"optimize",payload:{people:s.people,tables:s.tables,groups:s.groups,weeks:t.weeks,roles:t.roles}}),i.onmessage=t=>{let s=t.data.operation,a=t.data.payload;switch(s){case"result":{let t=a.person.length;l.zone.push(...Array(t).fill(e)),l.person.push(...a.person),l.table.push(...a.table),l.week.push(...a.week),l.group.push(...a.group),l.role.push(...a.role),i.terminate(),delete o[e],0===Object.keys(o).length&&(!function(e){let t=Object.keys(e),n=e[t[0]].length,o=[t];for(let r=0;r<n;r++){let n=[];for(let o of t)n.push(e[o][r]);o.push(n)}let r=new Blob([o.map(e=>e.join(",")).join("\n")],{type:"text/csv"}),l=URL.createObjectURL(r);window.open(l,"_blank")}(l),c(0));break}case"progress":r[e]=a,c(Object.values(r).reduce((e,t)=>e+t,0)/n);break;case"log":console.log(a)}},o[e]=i}};
//# sourceMappingURL=social_golfer_timetabling.e6ed3666.js.map

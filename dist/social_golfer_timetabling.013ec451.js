class e extends HTMLElement{button;constructor(){super(),this.button=document.createElement("button"),this.button.innerText="Test"}connectedCallback(){this.appendChild(this.button),this.button.onclick=this.#e.bind(this)}#e(){alert(this.getAttribute("bla"))}}customElements.define("fancy-button",e);const t={zones:{},weeks:12,roles:["Leader","Scribe","Researcher"]},n=document.getElementById("roles"),o=document.getElementById("progress"),s=document.getElementById("submit"),l=document.getElementById("csv"),r=document.getElementById("weeks"),i=document.getElementById("zone-table"),a=document.getElementById("error");let u=!1,p=0;function d(e){u=!0,s.disabled=!0,a.innerText=e}function c(){u&&(a.innerText="",s.disabled=!1),u=!1}function m(e){p=e,o.style.width=`${100*p}%`}document.addEventListener("DOMContentLoaded",()=>{l.value="",r.value=t.weeks,n.value=t.roles.join(", "),s.disabled=!0,m(p)}),n.oninput=e=>{t.roles=e.target.value.split(",").map(e=>e.trim())},r.oninput=e=>{let n=parseInt(e.target.value);if(!Number.isInteger(n)||n<2)return void d("Number of weeks must be an integer greater than 2.");t.weeks=n,c()},l.onchange=e=>{t.zones={},s.disabled=!0;let n=e.target.files[0];if(!n)return void d("Invalid CSV file.");let o=new FileReader;function l(e,t,n){let o=document.createElement("input");return o.id=e,o.type="number",o.step="1",o.value=t,o.min="2",o.oninput=n,o}o.onload=e=>{c();let n=e.target.result.split("\n");n.length<2&&d("CSV requires at least 2 rows.");let o=n[0].toLowerCase().split(",").map(e=>e.trim()),s=o.indexOf("name");if(-1===s)return void d("Required column `name` is missing.");let r=o.indexOf("zone"),a=Math.max(s,r),u={};for(let e of n.slice(1)){if(""==e)continue;let n=e.split(",").map(e=>e.trim());if(n.length<=a)return void d("Invalid CSV file.");let o=-1!==r?n[r]:"",l=n[s];if(u.hasOwnProperty(o)||(u[o]=new Set),u[o].has(l))return void d(`Each name in the CSV must be unique in each zone (duplicate '${o}'-'${l}').`);u[o].add(l),t.zones.hasOwnProperty(o)?t.zones[o].people.push(l):t.zones[o]={groups:2,tables:2,people:[l]}}i.getElementsByTagName("tbody")[0].innerHTML="",Object.keys(t.zones).forEach((e,n)=>{!function(e,n){let o=i.getElementsByTagName("tbody")[0].insertRow(),s=[];for(let e=0;e<5;e++)s.push(o.insertCell());let r=t.zones[n].people.length;s[0].innerText=""===n?"Unnamed":n,s[1].innerText=r;let a=Math.max(2,Math.ceil(r/6)),u=r/a;t.zones[n].tables=a,t.zones[n].groups=a,s[2].innerText=u.toFixed(2);let p=l(`groups-${e}`,a,e=>{let o=parseInt(e.target.value),l=t.zones[n].people.length;if(!Number.isInteger(o))return void d("Invalid number of groups.");t.zones[n].tables<o&&(s[4].firstChild.value=o),s[2].innerText=(l/o).toFixed(2),t.zones[n].groups=o,c()}),m=l(`tables-${e}`,a,e=>{let o=parseInt(e.target.value);return Number.isInteger(o)?o<t.zones[n].groups?void d(`Each group must have a table in '${n}'.`):void(t.zones[n].tables=o,c()):void d("Invalid number of tables.")});s[3].appendChild(p),s[4].appendChild(m)}(n,e)}),i.style.display="table"},o.readAsText(n),u||(s.disabled=!1)};var b={},g={};g=function(e,t,n){if(t===self.location.origin)return e;var o=n?"import "+JSON.stringify(e)+";":"importScripts("+JSON.stringify(e)+");";return URL.createObjectURL(new Blob([o],{type:"application/javascript"}))};let h=new URL(import.meta.resolve("2wF6P"));b=g(h.toString(),h.origin,!0),s.onclick=()=>{m(0);let e=structuredClone(t),n=Object.keys(e.zones).length,o={},s={},l={zone:[],week:[],person:[],table:[],group:[],role:[]};for(let[t,r]of Object.entries(e.zones)){let i=new Worker(b);i.postMessage({operation:"optimize",payload:{people:r.people,tables:r.tables,groups:r.groups,weeks:e.weeks,roles:e.roles}}),i.onmessage=e=>{let r=e.data.operation,a=e.data.payload;switch(r){case"result":{let e=a.person.length;l.zone.push(...Array(e).fill(t)),l.person.push(...a.person),l.table.push(...a.table),l.week.push(...a.week),l.group.push(...a.group),l.role.push(...a.role),i.terminate(),delete o[t],0===Object.keys(o).length&&(!function(e){let t=Object.keys(e),n=e[t[0]].length,o=[t];for(let s=0;s<n;s++){let n=[];for(let o of t)n.push(e[o][s]);o.push(n)}let s=new Blob([o.map(e=>e.join(",")).join("\n")],{type:"text/csv"}),l=URL.createObjectURL(s);window.open(l,"_blank")}(l),m(0));break}case"progress":s[t]=a,m(Object.values(s).reduce((e,t)=>e+t,0)/n);break;case"log":console.log(a)}},o[t]=i}};
//# sourceMappingURL=social_golfer_timetabling.013ec451.js.map

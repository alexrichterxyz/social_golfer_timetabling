const e={zones:{},weeks:12,roles:[""]},t=document.getElementById("roles"),n=document.getElementById("progress"),o=document.getElementById("submit"),l=document.getElementById("csv"),r=document.getElementById("weeks"),s=document.getElementById("zone-data"),a=document.getElementById("error");let i=!1,p=0;function u(e){i=!0,o.disabled=!0,a.innerText=e}function d(){i&&(a.innerText="",o.disabled=!1),i=!1}document.addEventListener("DOMContentLoaded",()=>{l.value="",r.value=e.weeks,t.value=e.roles.join(", "),m(p)}),t.oninput=t=>{e.roles=t.target.value.split(",").map(e=>e.trim())},r.oninput=t=>{let n=parseInt(t.target.value);if(!Number.isInteger(n)||n<2)return void u("Number of weeks must be an integer greater than 2.");e.weeks=n,d()};var c={};function m(e){p=e,n.style.width=`${100*p}%`}c=import.meta.resolve("6YfdT"),l.onchange=t=>{e.zones={};let n=t.target.files[0];if(!n)return void u("Invalid CSV file.");let o=new FileReader;function l(e,t,n,o){let l=document.createElement("label");l.setAttribute("for",e),l.textContent=t;let r=document.createElement("input");return r.id=e,r.type="number",r.step="1",r.value="2",r.min="2",r.oninput=o,{input:r,label:l}}o.onload=t=>{let n=t.target.result.split("\n");n.length<2&&u("CSV requires at least 2 rows.");let o=n[0].split(",").map(e=>e.trim()),r=o.indexOf("person");-1===r&&u("Required column `person` is missing.");let a=o.indexOf("zone"),i=Math.max(r,a);for(let t of n.slice(1)){if(""==t)continue;let n=t.split(",").map(e=>e.trim());n.length<=i&&u("Invalid CSV file.");let o=-1!==a?n[a]:"",l=n[r];e.zones.hasOwnProperty(o)?e.zones[o].people.push(l):e.zones[o]={groups:2,tables:2,people:[l]}}Object.keys(e.zones).forEach((t,n)=>{s.appendChild(function(t,n){document.createElement("li");let o=l(`groups-${2*t}`,"Number of groups",n,t=>{let o=parseInt(t.target.value);if(!Number.isInteger(o))return void u("Invalid number of groups");e.zones[n].groups=o,d()}),r=document.createElement("section"),s=document.createElement("h2"),a=document.createElement("img");a.src=new URL(c),a.alt="Zone",s.innerText=`${n} (${e.zones[n].people.length} people)`,s.appendChild(a),r.appendChild(s),r.appendChild(o.label),r.appendChild(o.input);let i=l(`tables-${2*t+1}`,"Number of tables",n,t=>{let o=parseInt(t.target.value);if(!Number.isInteger(o))return void u("Invalid number of tables");e.zones[n].tables=o,d()});return r.appendChild(i.label),r.appendChild(i.input),r}(n,t))})},s.innerHTML="",o.readAsText(n)};var g={},b={};b=function(e,t,n){if(t===self.location.origin)return e;var o=n?"import "+JSON.stringify(e)+";":"importScripts("+JSON.stringify(e)+");";return URL.createObjectURL(new Blob([o],{type:"application/javascript"}))};let f=new URL(import.meta.resolve("2wF6P"));g=b(f.toString(),f.origin,!0),o.onclick=()=>{m(0);let t=structuredClone(e),n=Object.keys(t.zones).length,o={},l={},r={zone:[],week:[],person:[],table:[],group:[],role:[]};for(let[e,s]of Object.entries(t.zones)){let a=new Worker(g);a.postMessage({operation:"optimize",payload:{people:s.people,tables:s.tables,groups:s.groups,weeks:t.weeks,roles:t.roles}}),a.onmessage=t=>{let s=t.data.operation,i=t.data.payload;switch(s){case"result":{let t=i.person.length;r.zone.push(...Array(t).fill(e)),r.person.push(...i.person),r.table.push(...i.table),r.week.push(...i.week),r.group.push(...i.group),r.role.push(...i.role),a.terminate(),delete o[e],0===Object.keys(o).length&&(!function(e){let t=Object.keys(e),n=e[t[0]].length,o=[t];for(let l=0;l<n;l++){let n=[];for(let o of t)n.push(e[o][l]);o.push(n)}let l=new Blob([o.map(e=>e.join(",")).join("\n")],{type:"text/csv"}),r=URL.createObjectURL(l);window.open(r,"_blank")}(r),m(0));break}case"progress":l[e]=i,m(Object.values(l).reduce((e,t)=>e+t,0)/n);break;case"log":console.log(i)}},o[e]=a}};
//# sourceMappingURL=social_golfer_timetabling.110971d3.js.map

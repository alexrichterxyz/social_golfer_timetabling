class e extends HTMLElement{button;constructor(){super(),this.button=document.createElement("button"),this.button.innerText="Test"}connectedCallback(){this.appendChild(this.button),this.button.onclick=this.#e.bind(this)}#e(){alert(this.getAttribute("bla"))}}customElements.define("fancy-button",e);const t={zones:{},weeks:12,roles:["Leader","Scribe","Researcher"]},n=document.getElementById("roles"),o=document.getElementById("progress"),r=document.getElementById("submit"),l=document.getElementById("csv"),s=document.getElementById("weeks"),i=document.getElementById("zone-table"),a=document.getElementById("error");let u=!1,p=0;function d(e){u=!0,r.disabled=!0,a.innerText=e}function c(){u&&(a.innerText="",r.disabled=!1),u=!1}function m(e){let t=[],n="",o=!1;for(let r=0;r<e.length;r++){let l=e[r];'"'===l?o&&'"'===e[r+1]?(n+='"',r++):o=!o:","!==l||o?n+=l:(t.push(n),n="")}return t.push(n),t}function g(e){return e.map(e=>{let t=String(e);return t.includes('"')&&(t=t.replace(/"/g,'""')),/[",\n]/.test(t)&&(t=`"${t}"`),t}).join(",")}function b(e){p=e,o.style.width=`${100*p}%`}document.addEventListener("DOMContentLoaded",()=>{l.value="",s.value=t.weeks,n.value=t.roles.join(", "),r.disabled=!0,b(p)}),n.oninput=e=>{t.roles=e.target.value.split(",").map(e=>e.trim())},s.oninput=e=>{let n=parseInt(e.target.value);if(!Number.isInteger(n)||n<2)return void d("Number of weeks must be an integer greater than 2.");t.weeks=n,c()},l.onchange=e=>{t.zones={},r.disabled=!0;let n=e.target.files[0];if(!n)return void d("Invalid CSV file.");let o=new FileReader;function l(e,t,n){let o=document.createElement("input");return o.id=e,o.type="number",o.step="1",o.value=t,o.min="2",o.oninput=n,o}o.onload=e=>{c();let n=e.target.result.split("\n");n.length<2&&d("CSV requires at least 2 rows.");let o=m(n[0].toLowerCase()).map(e=>e.trim()),r=o.indexOf("name");if(-1===r)return void d("Required column `name` is missing.");let s=o.indexOf("zone"),a=Math.max(r,s),u={};for(let e of n.slice(1)){if(""==e)continue;let n=m(e).map(e=>e.trim());if(n.length<=a)return void d("Invalid CSV file.");let o=-1!==s?n[s]:"",l=n[r];if(u.hasOwnProperty(o)||(u[o]=new Set),u[o].has(l))return void d(`Each name in the CSV must be unique in each zone (duplicate '${o}'-'${l}').`);u[o].add(l),t.zones.hasOwnProperty(o)?t.zones[o].people.push(l):t.zones[o]={groups:2,tables:2,people:[l]}}i.getElementsByTagName("tbody")[0].innerHTML="",Object.keys(t.zones).forEach((e,n)=>{!function(e,n){let o=i.getElementsByTagName("tbody")[0].insertRow(),r=[];for(let e=0;e<5;e++)r.push(o.insertCell());let s=t.zones[n].people.length;r[0].innerText=""===n?"Unnamed":n,r[1].innerText=s;let a=Math.max(2,Math.ceil(s/6)),u=s/a;t.zones[n].tables=a,t.zones[n].groups=a,r[2].innerText=u.toFixed(2);let p=l(`groups-${e}`,a,e=>{let o=parseInt(e.target.value),l=t.zones[n].people.length;if(!Number.isInteger(o))return void d("Invalid number of groups.");t.zones[n].tables<o&&(r[4].firstChild.value=o),r[2].innerText=(l/o).toFixed(2),t.zones[n].groups=o,c()}),m=l(`tables-${e}`,a,e=>{let o=parseInt(e.target.value);return Number.isInteger(o)?o<t.zones[n].groups?void d(`Each group must have a table in '${n}'.`):void(t.zones[n].tables=o,c()):void d("Invalid number of tables.")});r[3].appendChild(p),r[4].appendChild(m)}(n,e)}),i.style.display="table"},o.readAsText(n),u||(r.disabled=!1)};var h={},f={};f=function(e,t,n){if(t===self.location.origin)return e;var o=n?"import "+JSON.stringify(e)+";":"importScripts("+JSON.stringify(e)+");";return URL.createObjectURL(new Blob([o],{type:"application/javascript"}))};let v=new URL(import.meta.resolve("2wF6P"));h=f(v.toString(),v.origin,!0),r.onclick=()=>{b(0);let e=structuredClone(t),n=Object.keys(e.zones).length,o={},r={},l={zone:[],week:[],person:[],table:[],group:[],role:[]};for(let[t,s]of Object.entries(e.zones)){let i=new Worker(h);i.postMessage({operation:"optimize",payload:{people:s.people,tables:s.tables,groups:s.groups,weeks:e.weeks,roles:e.roles}}),i.onmessage=e=>{let s=e.data.operation,a=e.data.payload;switch(s){case"result":{let e=a.person.length;l.zone.push(...Array(e).fill(t)),l.person.push(...a.person),l.table.push(...a.table),l.week.push(...a.week),l.group.push(...a.group),l.role.push(...a.role),i.terminate(),delete o[t],0===Object.keys(o).length&&(!function(e){let t=Object.keys(e),n=e[t[0]].length,o=[t];for(let r=0;r<n;r++){let n=[];for(let o of t)n.push(e[o][r]);o.push(n)}let r=new Blob([o.map(g).join("\n")],{type:"text/csv"}),l=URL.createObjectURL(r);window.open(l,"_blank")}(l),b(0));break}case"progress":r[t]=a,b(Object.values(r).reduce((e,t)=>e+t,0)/n);break;case"log":console.log(a)}},o[t]=i}};
//# sourceMappingURL=social_golfer_timetabling.293ac25a.js.map

const e={zones:{},weeks:12,roles:[""]},t=document.getElementById("roles"),n=document.getElementById("progress"),l=document.getElementById("submit"),o=document.getElementById("csv"),r=document.getElementById("weeks"),s=document.getElementById("zone-data"),a=document.getElementById("error");let i=!1,p=0;function u(e){i=!0,l.disabled=!0,a.innerText=e}function d(){i&&(a.innerText="",l.disabled=!1),i=!1}function c(e){p=e,n.value=e}document.addEventListener("DOMContentLoaded",()=>{o.value="",r.value=e.weeks,t.value=e.roles.join(", "),n.value=p}),t.oninput=t=>{e.roles=t.target.value.split(",").map(e=>e.trim())},r.oninput=t=>{let n=parseInt(t.target.value);if(!Number.isInteger(n)||n<2)return void u("Number of weeks must be an integer greater than 2.");e.weeks=n,d()},o.onchange=t=>{e.zones={};let n=t.target.files[0];if(!n)return void u("Invalid CSV file.");let l=new FileReader;function o(e,t,n,l){let o=document.createElement("label");o.setAttribute("for",e),o.textContent=t;let r=document.createElement("input");return r.id=e,r.type="number",r.step="1",r.value="2",r.min="2",r.oninput=l,{input:r,label:o}}l.onload=t=>{let n=t.target.result.split("\n");n.length<2&&u("CSV requires at least 2 rows.");let l=n[0].split(",").map(e=>e.trim()),r=l.indexOf("person");-1===r&&u("Required column `person` is missing.");let a=l.indexOf("zone"),i=Math.max(r,a);for(let t of n.slice(1)){if(""==t)continue;let n=t.split(",").map(e=>e.trim());n.length<=i&&u("Invalid CSV file.");let l=-1!==a?n[a]:"",o=n[r];e.zones.hasOwnProperty(l)?e.zones[l].people.push(o):e.zones[l]={groups:2,tables:2,people:[o]}}Object.keys(e.zones).forEach((t,n)=>{s.appendChild(function(t,n){let l=document.createElement("li"),r=o(`groups-${2*t}`,"Number of groups",n,t=>{let l=parseInt(t.target.value);if(!Number.isInteger(l))return void u("Invalid number of groups");e.zones[n].groups=l,d()}),s=document.createElement("p");s.innerText=`${n} (${e.zones[n].people.length} people)`,l.appendChild(s),l.appendChild(r.label),l.appendChild(r.input);let a=o(`tables-${2*t+1}`,"Number of tables",n,t=>{let l=parseInt(t.target.value);if(!Number.isInteger(l))return void u("Invalid number of tables");e.zones[n].tables=l,d()});return l.appendChild(a.label),l.appendChild(a.input),l}(n,t))})},s.innerHTML="",l.readAsText(n)};var m={},g={};g=function(e,t,n){if(t===self.location.origin)return e;var l=n?"import "+JSON.stringify(e)+";":"importScripts("+JSON.stringify(e)+");";return URL.createObjectURL(new Blob([l],{type:"application/javascript"}))};let b=new URL(import.meta.resolve("2wF6P"));m=g(b.toString(),b.origin,!0),l.onclick=()=>{c(0);let t=structuredClone(e),n=Object.keys(t.zones).length,l={},o={},r={zone:[],week:[],person:[],table:[],group:[],role:[]};for(let[e,s]of Object.entries(t.zones)){let a=new Worker(m);a.postMessage({operation:"optimize",payload:{people:s.people,tables:s.tables,groups:s.groups,weeks:t.weeks,roles:t.roles}}),a.onmessage=t=>{let s=t.data.operation,i=t.data.payload;switch(s){case"result":{let t=i.person.length;r.zone.push(...Array(t).fill(e)),r.person.push(...i.person),r.table.push(...i.table),r.week.push(...i.week),r.group.push(...i.group),r.role.push(...i.role),a.terminate(),delete l[e],0===Object.keys(l).length&&function(e){let t=Object.keys(e),n=e[t[0]].length,l=[t];for(let o=0;o<n;o++){let n=[];for(let l of t)n.push(e[l][o]);l.push(n)}let o=new Blob([l.map(e=>e.join(",")).join("\n")],{type:"text/csv"}),r=URL.createObjectURL(o);window.open(r,"_blank")}(r),c(1);break}case"progress":o[e]=i,c(Object.values(o).reduce((e,t)=>e+t,0)/n);break;case"log":console.log(i)}},l[e]=a}};
//# sourceMappingURL=social_golfer_timetabling.824066ab.js.map

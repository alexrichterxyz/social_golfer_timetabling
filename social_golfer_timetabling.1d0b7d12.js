const e={zones:{},weeks:12,roles:[""]},t=document.getElementById("roles");document.getElementById("progress");const n=document.getElementById("submit"),o=document.getElementById("csv"),l=document.getElementById("weeks"),r=document.getElementById("zone-data"),s=document.getElementById("error");let i=!1;function a(e){i=!0,s.innerText=e}function p(){i&&(s.innerText=""),i=!1}o.value="",l.value=e.weeks,t.value=e.roles.join(", "),t.oninput=t=>{e.roles=t.target.value.split(",").map(e=>e.trim()),console.log(e.roles)},l.oninput=t=>{let n=parseInt(t.target.value);if(!Number.isInteger(n)||n<2)return void a("Number of weeks must be an integer greater than 2.");e.weeks=n,p()},o.onchange=t=>{e.zones={};let n=t.target.files[0];n||a("Invalid CSV file.");let o=new FileReader;function l(e,t,n,o){let l=document.createElement("label");l.setAttribute("for",e),l.textContent=t;let r=document.createElement("input");return r.id=e,r.type="number",r.step="1",r.value="2",r.min="2",r.oninput=o,{input:r,label:l}}o.onload=t=>{let n=t.target.result.split("\n");n.length<2&&a("CSV requires at least 2 rows.");let o=n[0].split(",").map(e=>e.trim()),s=o.indexOf("person");-1===s&&a("Required column `person` is missing.");let i=o.indexOf("zone"),u=Math.max(s,i);for(let t of n.slice(1)){if(""==t)continue;let n=t.split(",").map(e=>e.trim());n.length<=u&&a("Invalid CSV file.");let o=-1!==i?n[i]:"",l=n[s];e.zones.hasOwnProperty(o)?e.zones[o].people.push(l):e.zones[o]={groups:2,tables:2,people:[l]}}Object.keys(e.zones).forEach((t,n)=>{r.appendChild(function(t,n){let o=document.createElement("li"),r=l(`groups-${2*t}`,"Number of groups",n,t=>{let o=parseInt(t.target.value);if(!Number.isInteger(o))return void a("Invalid number of groups");e.zones[n].groups=o,p()}),s=document.createElement("p");s.innerText=`${n} (${e.zones[n].people.length} people)`,o.appendChild(s),o.appendChild(r.label),o.appendChild(r.input);let i=l(`tables-${2*t+1}`,"Number of tables",n,t=>{let o=parseInt(t.target.value);if(!Number.isInteger(o))return void a("Invalid number of tables");e.zones[n].tables=o,p()});return o.appendChild(i.label),o.appendChild(i.input),o}(n,t))})},r.innerHTML="",o.readAsText(n)};var u={},d={};d=function(e,t,n){if(t===self.location.origin)return e;var o=n?"import "+JSON.stringify(e)+";":"importScripts("+JSON.stringify(e)+");";return URL.createObjectURL(new Blob([o],{type:"application/javascript"}))};let c=new URL(import.meta.resolve("2wF6P"));u=d(c.toString(),c.origin,!0),n.onclick=()=>{let t=structuredClone(e),n={},o={zone:[],week:[],person:[],table:[],group:[],role:[]};for(let[e,l]of Object.entries(t.zones)){console.log(e);let r=new Worker(u);r.postMessage({operation:"optimize",payload:{people:l.people,tables:l.tables,groups:l.groups,weeks:t.weeks,roles:t.roles}}),r.onmessage=t=>{let l=t.data.operation,s=t.data.payload;switch(l){case"result":{let t=s.person.length;o.zone.push(...Array(t).fill(e)),o.person.push(...s.person),o.table.push(...s.table),o.week.push(...s.week),o.group.push(...s.group),o.role.push(...s.role),r.terminate(),delete n[e],0===Object.keys(n).length&&function(e){let t=Object.keys(e),n=e[t[0]].length,o=[t];for(let l=0;l<n;l++){let n=[];for(let o of t)n.push(e[o][l]);o.push(n)}let l=new Blob([o.map(e=>e.join(",")).join("\n")],{type:"text/csv"}),r=URL.createObjectURL(l);window.open(r,"_blank")}(o);break}case"log":console.log(s)}},n[e]=r}};
//# sourceMappingURL=social_golfer_timetabling.1d0b7d12.js.map

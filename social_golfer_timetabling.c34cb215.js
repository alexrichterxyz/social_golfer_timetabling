class e extends HTMLElement{button;constructor(){super(),this.button=document.createElement("button"),this.button.innerText="Test"}connectedCallback(){this.appendChild(this.button),this.button.onclick=this.#e.bind(this)}#e(){alert(this.getAttribute("bla"))}}customElements.define("fancy-button",e);const t={zones:{},weeks:12,roles:["Leader","Scribe","Researcher"]},n=document.getElementById("roles"),o=document.getElementById("progress"),l=document.getElementById("submit"),r=document.getElementById("csv"),s=document.getElementById("weeks"),i=document.getElementById("zone-table"),a=document.getElementById("error");let u=!1,p=0;function d(e){u=!0,l.disabled=!0,a.innerText=e}function c(){u&&(a.innerText="",l.disabled=!1),u=!1}function m(e){let t=[],n="",o=!1;for(let l=0;l<e.length;l++){let r=e[l];'"'===r?o&&'"'===e[l+1]?(n+='"',l++):o=!o:","!==r||o?n+=r:(t.push(n),n="")}return t.push(n),t}function g(e){p=e,o.style.width=`${100*p}%`}document.addEventListener("DOMContentLoaded",()=>{r.value="",s.value=t.weeks,n.value=t.roles.join(", "),l.disabled=!0,g(p)}),n.oninput=e=>{t.roles=e.target.value.split(",").map(e=>e.trim())},s.oninput=e=>{let n=parseInt(e.target.value);if(!Number.isInteger(n)||n<2)return void d("Number of weeks must be an integer greater than 2.");t.weeks=n,c()},r.onchange=e=>{t.zones={},l.disabled=!0;let n=e.target.files[0];if(!n)return void d("Invalid CSV file.");let o=new FileReader;function r(e,t,n){let o=document.createElement("input");return o.id=e,o.type="number",o.step="1",o.value=t,o.min="2",o.oninput=n,o}o.onload=e=>{c();let n=e.target.result.split("\n");n.length<2&&d("CSV requires at least 2 rows.");let o=m(n[0].toLowerCase()).map(e=>e.trim()),l=o.indexOf("name");if(-1===l)return void d("Required column `name` is missing.");let s=o.indexOf("zone"),a=Math.max(l,s),u={};for(let e of n.slice(1)){if(""==e)continue;let n=m(e).map(e=>e.trim());if(n.length<=a)return void d("Invalid CSV file.");let o=-1!==s?n[s]:"",r=n[l];if(u.hasOwnProperty(o)||(u[o]=new Set),u[o].has(r))return void d(`Each name in the CSV must be unique in each zone (duplicate '${o}'-'${r}').`);u[o].add(r),t.zones.hasOwnProperty(o)?t.zones[o].people.push(r):t.zones[o]={groups:2,tables:2,people:[r]}}i.getElementsByTagName("tbody")[0].innerHTML="",Object.keys(t.zones).forEach((e,n)=>{!function(e,n){let o=i.getElementsByTagName("tbody")[0].insertRow(),l=[];for(let e=0;e<5;e++)l.push(o.insertCell());let s=t.zones[n].people.length;l[0].innerText=""===n?"Unnamed":n,l[1].innerText=s;let a=Math.max(2,Math.ceil(s/6)),u=s/a;t.zones[n].tables=a,t.zones[n].groups=a,l[2].innerText=u.toFixed(2);let p=r(`groups-${e}`,a,e=>{let o=parseInt(e.target.value),r=t.zones[n].people.length;if(!Number.isInteger(o))return void d("Invalid number of groups.");t.zones[n].tables<o&&(l[4].firstChild.value=o),l[2].innerText=(r/o).toFixed(2),t.zones[n].groups=o,c()}),m=r(`tables-${e}`,a,e=>{let o=parseInt(e.target.value);return Number.isInteger(o)?o<t.zones[n].groups?void d(`Each group must have a table in '${n}'.`):void(t.zones[n].tables=o,c()):void d("Invalid number of tables.")});l[3].appendChild(p),l[4].appendChild(m)}(n,e)}),i.style.display="table"},o.readAsText(n),u||(l.disabled=!1)};var b={},h={};h=function(e,t,n){if(t===self.location.origin)return e;var o=n?"import "+JSON.stringify(e)+";":"importScripts("+JSON.stringify(e)+");";return URL.createObjectURL(new Blob([o],{type:"application/javascript"}))};let f=new URL(import.meta.resolve("2wF6P"));b=h(f.toString(),f.origin,!0),l.onclick=()=>{g(0);let e=structuredClone(t),n=Object.keys(e.zones).length,o={},l={},r={zone:[],week:[],person:[],table:[],group:[],role:[]};for(let[t,s]of Object.entries(e.zones)){let i=new Worker(b);i.postMessage({operation:"optimize",payload:{people:s.people,tables:s.tables,groups:s.groups,weeks:e.weeks,roles:e.roles}}),i.onmessage=e=>{let s=e.data.operation,a=e.data.payload;switch(s){case"result":{let e=a.person.length;r.zone.push(...Array(e).fill(t)),r.person.push(...a.person),r.table.push(...a.table),r.week.push(...a.week),r.group.push(...a.group),r.role.push(...a.role),i.terminate(),delete o[t],0===Object.keys(o).length&&(!function(e){let t=Object.keys(e),n=e[t[0]].length,o=[t];for(let l=0;l<n;l++){let n=[];for(let o of t)n.push(e[o][l]);o.push(n)}let l=new Blob([o.map(e=>e.join(",")).join("\n")],{type:"text/csv"}),r=URL.createObjectURL(l);window.open(r,"_blank")}(r),g(0));break}case"progress":l[t]=a,g(Object.values(l).reduce((e,t)=>e+t,0)/n);break;case"log":console.log(a)}},o[t]=i}};
//# sourceMappingURL=social_golfer_timetabling.c34cb215.js.map
